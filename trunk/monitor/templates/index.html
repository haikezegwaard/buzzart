<!doctype HTML>
<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<!-- Bootstrap Core CSS -->
{% load staticfiles %}
<link href="{% static 'css/bootstrap.css' %}" rel="stylesheet">
<script src="{% static 'js/bootstrap.js' %}"></script>
<link href="{% static 'css/bs-callouts.css' %}" rel="stylesheet">
</head>
<body>
    <div class="bs-docs-section">
        <div class="bs-callout bs-callout-info">
            <h4>Helper functies</h4>
            <p>
                <div class="list-group">
                  <a href="/niki/projects" class="list-group-item">Alle niki projecten</a>
                  <div class="input-group">
                    <span class="input-group-btn">
                    <button class="btn btn-default"  id="mc_lists" >Mailchimp lijsten</button>
                    </span>
                    <input type="text" id="apikey" class="form-control" placeholder="api token">
                  </div>
                </div>
            </p>
        </div>
    </div>
    <div class="page-header">
      <h1>Projectoverzicht <small>klik op 'overzicht' voor een preview van de mailing</small></h1>
    </div>
    <div class="panel panel-default">
        <!-- Default panel contents -->
        <div class="panel-heading">Bestaande overzichten</div>
        <div class="panel-body">
            <table class="table">
                <tr><th>Project</th><th>Periode</th><th>Mailing</th></tr>
                {% for summary in summaries %}
                <tr>
                    <td>{{ summary.project.name }} ( {{ summary.project.manager }} )</td>
                    <td>{{ summary.dateStart }} - {{ summary.dateEnd }}</td>
                    <td><a href='/digest/{{summary.id}}'>preview</a></td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>







<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="myModalLabel">Mailchimp lijsten</h4>
      </div>
      <div class="modal-body">
        <ul id="mc_lists_group" class="list-group">
        </ul>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>









    <script>
        $(document).ready(function(){
          $('#mc_lists').click(function() {
            $.getJSON('/mailchimp/lists/?apikey='+$('#apikey').val(), function(data) {
                for(i = 0; i < data.data.length ; i++){
                    console.log(data.data[i].name + ' : ' + data.data[i].web_id);
                    $("#mc_lists_group").append("<li class='list-group-item'>"+data.data[i].name + ' : ' + data.data[i].web_id+"</li>");
                }

            });
            $('#myModal').modal()
          });
        });
    </script>
</body>
</html>